---
title: "Learn some interesting R stuff"
author: "Nilotpal Sanyal  \n\n [https://nilotpalsanyal.github.io](https://nilotpalsanyal.github.io)"
output: 
 html_document:
  # code_folding: show
  toc: true
  toc_depth: 3  
  toc_float: FALSE        
  number_sections: no   
  # theme: united        
  highlight: tango 
urlcolor: blue
citecolor: blue
---

<!-- # set the overall width of the HTML page -->
<style type="text/css"> /* This sets the overall width of the HTML page */
  .main-container {
    max-width: 800px;   
    margin-left: auto;
    margin-right: auto;
  }
  body, td {
     font-size: 16.5px;
     font-family: Calibri;
     background: rgb(250,250,250);
  }
  code.r{					/*for r code*/
    font-size: 15px;
  }
  pre {					/*for output of knitr chunks*/
    font-size: 16.5px
    border: 0;
  }
</style>

```{r setup, include=FALSE}
knitr::opts_chunk$set(eval = FALSE)
```

<hr>

Here's a bunch of interesting R stuff I put together for learning and fun.

<hr>









**See which packages and dataframes are currently attached**

```{r} 
search()
```

**Manually edit an R object, say, a function**

```{r}
fix(function) #edit in opened window and save
```

**See, save and load command history**

```{r}
history(max.show=20)
history(Inf)
savehistory(file = "fname.txt")
loadhistory(file = "fname.txt")
```

**Read a table with header**

```{r}
read.table("table.txt", header=T)
#or easier
read.delim("table.txt")
```

**See first/last parts of an R object**

```{r}
head(table)
tail(table)
```

**See manuals and references of R itself**

```{r}
help.start()
```

**Check if an object exists**

```{r}
exists(x)
```

**See all loaded packages with versions**

```{r}
sessionInfo()
```

**Copy from clipboard**

```{r}
# Windows
a <- writeClipboard(as.character(factor.name))
a <- writeClipboard(as.character(numeric.variable))

# Mac
a <- read.table(pipe("pbpaste"), header = TRUE) 
```

**Shut down computer after a wait time**

```{r}
library(fun)
shutdown(wait=10)  #10 sec
```

**E-mail from within R** 

```{r}
library(mailR)

send.mail(
    from="your@gmail.com", to="another@gmail.com", 
          subject="Hi there", body="How are you?", 
          smtp=list(host.name = "smtp.gmail.com", port = 25, 
          user.name = "yourusername", passwd = "yourpass", ssl = T), 
          authenticate = T, send=T, attach.files="link-to-file")
```

**Create animated graphics in R**

```{r}
install.packages(“animation”)
saveGIF({
 # code for all plots
})
```

**Various tolerance limits in R**

```{r}
.Machine
```

**Make all possible concatenations out of two character vectors**

```{r, eval=TRUE}
a = c(200,400,600)
b = c(2,3,4)
comb = c( outer(a, b, FUN=paste, sep="-") )
comb
```

**Make all possible concatenations out of multiple(>=2) character vectors**

```{r, eval=TRUE}
a = c("a","b")
b = c("A","B","C")
d = c("X","Y")
e = c("1","2","3")
out = as.character( Reduce( function(X,Y) outer(X,Y,FUN = paste, sep = "."), 
                     list(a, b, d, e) ) )
out
```

**List all functions used in an R script**

```{r}
library(NCmisc)
list.functions.in.file( filename = "blabla.R")
```

**Print to a text file**

```{r}
# option 1
fileConn <- file("output.txt")
writeLines(c("Hello","World"), fileConn)
close(fileConn)

# option 2
sink("output.txt")
cat("hello")
cat("\n")
cat("world")
sink()
```

**See size of an R object**

```{r, eval=TRUE}
x = rnorm(10000)
# Provides an estimate of the memory that is being used to store an R object
object.size(x)  # size in byte
# But a better function for calculating exact size is
lobstr::obj_size(x)
# They won't match for sequences because object.size does not correctly account
# for shared references and will return too large sizes. E.g., for sequences 
# created with :, R versions >= 3.5.0 only store the first and last numbers. 
object.size(1:2)
object.size(1:20000)
lobstr::obj_size(1:2)
lobstr::obj_size(1:20000)
```

**Get size of the workspace**

```{r}
workspace.size <- function() 
{
  ws <- sum(sapply(ls(envir=globalenv()), function(x)object.size(get(x))))
  class(ws) <- "object_size"
  ws
}
workspace.size()
```

**See internal functions which are not loaded**

```{r}
getAnywhere(func)
```

**See all names or all variables used in an expression**

```{r, eval=TRUE}
all.names(expression(sin(x+y)))
all.vars(expression(sin(x+y)))
```

**Change case of letters in a string**

```{r, eval=TRUE}
tolower("Hello")
toupper("hello")
```

**Treat a vector as a one-column matrix to get dimensions**

```{r, eval=TRUE}
vec = 1:3
NCOL(vec)
NROW(vec)
nrow(NULL)
NROW(NULL)  
```

**Make duplicates in a character vector unique**

```{r, eval=TRUE}
vec <- c("ab","cd","ef","ab")
make.unique(vec, sep = ".")  #appends sequence numbers to duplicates
```

**Gather a bunch of objects in a list**

```{r}
#you can do
list(a=a, b=b, d=d, t=t)
#or, simply
mget(list(a,b,c,d))
```

**Don't print out numbers in scientific format, keep decimal form**

```{r}
options(scipen=999) 
```

**Create an empty list of given length**

```{r, eval=TRUE}
a = vector("list", length = 3)
a
```

**Show progress by increasing a counter (instead of printing i sequencially)**

```{r}
# check by running
for (i in 1:10) {
    cat(i, " \r")
    flush.console()
    Sys.sleep(0.3)
}
```

**You cannot set the following names**

```{r}
_hi <- 2    #names cannot start with _
.hi <- 2    #names cannot start with .
?Reserved   #names cannot be a reserved word like if, else, etc.
```

**Dataset related to U.S. states**

```{r}
state.abb
state.area
state.center
state.division
state.name
state.region
state.x77
```

**How much memory is currently used by R?**

```{r}
lobstr::mem_used()
```

**Define named vector in single line**

```{r}
x <- setNames(1:3, c("a", "b", "c"))
```

**Avoiding else**

```{r}
if(x < 2) y=3 else y=NULL
# write simply as
y <- if(x < 2) 3
```

**Avoiding multiple if-else**

```{r}
func <- function(x) {
  if (x == "a") {
    "option 1"
  } else if (x == "b") {
    "option 2" 
  } else if (x == "c") {
    "option 3"
  } else {
    stop("Invalid `x` value")
  }
}
# a more compact way to write the above
func <- function(x) {
  switch(x,
    a = "option 1",
    b = "option 2",
    c = "option 3",
    stop("Invalid `x` value")
  )
}
```

**Evaluate a multivariate function over a grid of values**

```{r, eval=TRUE}
f = function(x,y,z) x + y + z
mapply(f, 1:3, 4:6, 7:9)
```

**Get list of all functions currently in global environment**

```{r}
funs <- Filter(is.function, mget(ls()))
names(fun)
```

**Get list of all objects of an attached package**

```{r}
library(dplyr)
ls("package:dplyr")
```

**Find the index of the first/last vector element satisfying a condition**

```{r}
Find( function(x){x^2 < 10}, 1:20, right=FALSE )
Find( function(x){x^2 < 10}, 1:20, right=TRUE )
```

**Piping**

```{r, eval=TRUE}
f = function(x) x+2
g = function(y) 3*y
f(g(4))
# another way using piping operator
library(magrittr)
4 %>% g() %>% f()
```

**Function arguments can be defined interdependently**

```{r, eval=TRUE}
f = function(x, y=2*x){x + y}
f(3)
```

**Function arguments can be defined in terms of body variables**

```{r}
f = function(x, y=a){
    a = 3
    x+y
}
f(10)
```

**Set a variable in the global environment from within a function environment**

```{r, eval=TRUE}
f <- function(){
    zz <<- 5        # called super assignment
    zz+4
}
f()
zz
```

****

```{r}

```

****

```{r}

```

****

```{r}

```

****

```{r}

```

****

```{r}

```

****

```{r}

```

****

```{r}

```

****

```{r}

```

****

```{r}

```

****

```{r}

```

****

```{r}

```








$$\\[1in]$$







$$\\[3in]$$










